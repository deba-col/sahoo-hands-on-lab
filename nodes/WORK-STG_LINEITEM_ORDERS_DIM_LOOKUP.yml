steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-391b13e9-015e-491f-b4a0-7eb7a53f9b6e:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 7e10c2dc-8e38-45fb-9cbb-4a96108cac99
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: da44aba4-3a74-4a33-9d46-f3c9921adb6b
                    stepCounter: bb315490-183d-43ef-a4ca-2b967b134caf
                transform: ""
          - columnReference:
              columnCounter: e71f49ee-5028-432a-bd9d-d4d9a1d3f262
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 61316822-20bc-42a3-a741-8826b5c5c769
                    stepCounter: 493ef9fa-f575-4c53-a248-3d023a294378
                transform: ""
          - columnReference:
              columnCounter: 3b01ba47-9138-4e29-a67b-9446a46a61bd
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 37ca11f7-cd25-4821-8b63-a409e854ded1
                    stepCounter: 4731e5ff-247e-458a-96b9-46cac7d2405c
                transform: ""
          - columnReference:
              columnCounter: 4a6da0c2-1446-4d33-b5c3-d9dd5dc94569
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0f28bc77-9f60-4ee2-8094-a0c778144dd8
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 9d89df27-19ec-4407-ac0f-837b85f948c7
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 585b5e97-5c18-402b-8cd5-afe75facd5e4
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: f1b4bf51-17f2-4709-8733-27556ffcb226
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a43fe3a9-46d0-473f-8f82-541d4ba8eed1
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: b75bfee2-2db3-4926-874c-af118aaee636
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 04b07378-5f3b-40fd-9970-d4d4a52566a5
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 859319fb-8737-479e-9468-9d6e86a80cf6
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a686fbf9-ccda-48a1-acc0-cc6e050c0389
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 2d74de60-2893-4273-91f5-06605e957094
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3777e307-f0f2-4f5b-a290-d1c8fa273d29
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: aacf82f1-2abd-4a3e-a948-94c8f47f1c00
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aa3e6340-6aaa-453b-be39-a574d931af67
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 77869e38-45f4-4503-be47-3624dea2d13e
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0706e1b2-7c2d-4b47-bb24-edb1b506ebc0
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 6225711a-8120-42d4-85d8-31e75f84f148
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 50dcc06d-c931-47cf-b95b-9538e25ed661
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 934cb209-772f-41e2-8d9c-0cd054f0b2dc
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 16ee9fb5-e93c-4160-b60e-8f21fa669602
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 947cd56d-bc75-4eae-87e9-06b61e30e226
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7baf2509-471e-4695-9505-893301ad3580
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 2677c207-cc21-4590-954a-494283345ead
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ce99c8fc-03c8-40c0-a874-eb4be4e72d62
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: b29034c6-9529-4f61-986d-0715156a1aa1
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 456985aa-ee5d-4369-9de2-1fcd42ada3df
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: c45732bd-0af7-4794-bdf9-80f0f78a66d9
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a2ae519d-4666-4834-8666-c9434f643309
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: d2ac5315-5433-4d67-baf4-24226339dac7
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 33151a6f-7a19-4f12-8445-d6853f42e03b
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 6d9e3803-e7b0-4b2d-9725-ccb78e11e25f
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 69fc2529-41c2-4fca-8444-8e909ec141fd
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: a11b409b-7b4e-4c5b-9ac8-fc4641639dbe
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 637ab401-8971-4296-97b6-858b2974b7f3
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: cf1cb205-21e6-4c75-85ae-711e7392a796
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 58b81f5a-2eea-4a9c-b135-d8918e447457
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 4edb5251-e49f-4b23-970b-abcf39acfe82
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: be72f299-a9e6-4076-aa17-478ac83f3271
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: f19ba32c-c760-4d2c-b769-230fe0bc02b6
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bdd31fcc-d152-4456-b20a-5a9f5c9a79f6
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: f082d47b-1c87-4457-b61d-f872b4b4984a
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f429b7c4-9685-4aff-a1c8-369341f5821e
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: fabd9472-0f7e-4559-a346-559ca42cbdbd
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dc337400-7e43-4e5b-8f11-1624aab3244c
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: b7a1f198-a71a-4931-ae8e-f787986d1fbc
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 876749d2-ba86-45bd-916a-d127583ad544
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: a2abad98-507d-48ed-b830-3347319f3873
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 603aa76e-668f-486f-b2cf-231088e75ced
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 46a286ec-417d-446f-b9b3-f0949b8b2445
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0636f747-b54c-49d6-80f2-eb25128b0ec2
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: a41bbd78-5b3a-4b33-9a7e-f341119292fd
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6e321cb1-eb21-45a1-b53f-b25a6a3ed410
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - columnReference:
              columnCounter: 20757432-18d0-4ca0-ab97-3ac89961cd44
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8e33678a-9a52-4b26-b515-fb0c34342aef
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a0251e1f-272c-4d6a-bd52-220c0646fa4b
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ba3796c7-07ff-48b1-a7ed-134704a8e666
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f0d2c4bc-67b7-4853-8fb5-cdf62a263d7b
              stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c1244745-2577-4443-a176-d654c57c2845
                    stepCounter: df2b22f0-9027-499f-a985-d75b9eee3af6
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: bb315490-183d-43ef-a4ca-2b967b134caf
              DIM_PART: 493ef9fa-f575-4c53-a248-3d023a294378
              DIM_SUPPLIER: 4731e5ff-247e-458a-96b9-46cac7d2405c
              STG_LINEITEM_ORDERS: df2b22f0-9027-499f-a985-d75b9eee3af6
              STG_PARTSUPP: 7a2a3a23-04f4-43a0-89fd-1d5890335857
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 391b13e9-015e-491f-b4a0-7eb7a53f9b6e
